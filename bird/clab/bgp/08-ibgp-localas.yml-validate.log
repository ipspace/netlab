[ospf_adj_dut]  Check OSPF adjacencies with DUT [ node(s): x3 ]
[WAITING]       Waiting for OSPF adjacency process to complete (retrying for 30 seconds)
[PASS]          x3: OSPFv2 neighbor 10.0.0.1 is in state Full/-
[PASS]          Test succeeded in 7.8 seconds

[bgp_dut]       Check BGP sessions with DUT (wait up to 10 seconds) [ node(s): x1,x2,x3 ]
[PASS]          x1: Neighbor 172.16.0.1 (dut) is in state Established
[PASS]          x2: Neighbor 172.16.1.1 (dut) is in state Established
[WAITING]       Wait for BGP sessions to be established (retrying for 30 seconds)
[PASS]          x3: Neighbor 172.16.2.1 (dut) is in state Established
[PASS]          Test succeeded in 6.9 seconds

[ibgp_x4]       Check IBGP sessions X2-X4 [ node(s): x2 ]
[PASS]          x2: Neighbor 172.42.4.1 (x4) is in state Established
[PASS]          Test succeeded in 0.1 seconds

[prefix]        Check whether DUT advertises the beacon prefix [ node(s): x1,x2,x3,x4 ]
[PASS]          x1: The prefix 172.42.42.0/24 is in the BGP table
[PASS]          x2: The prefix 172.42.42.0/24 is in the BGP table
[PASS]          x3: The prefix 172.42.42.0/24 is in the BGP table
[PASS]          x4: The prefix 172.42.42.0/24 is in the BGP table
[PASS]          Test succeeded in 0.4 seconds

[prop_ebgp]     Check whether DUT propagates EBGP routes to IBGP [ node(s): x2,x3,x4 ]
[PASS]          x2: The prefix 172.42.1.0/24 is in the BGP table
[PASS]          x3: The prefix 172.42.1.0/24 is in the BGP table
[PASS]          x4: The prefix 172.42.1.0/24 is in the BGP table
[PASS]          Test succeeded in 0.3 seconds

[prop_ebgp_nh]  Check whether DUT sets the correct NH for EBGP routes sent to local-as IBGP session [ node(s): x2 ]
[PASS]          x2: The prefix 172.42.1.0/24 is in the BGP table with best path=True
[PASS]          Test succeeded in 0.1 seconds

[prop_la_ebgp]  Check whether DUT propagates local-as IBGP routes to EBGP neighbors [ node(s): x1 ]
[PASS]          x1: The prefix 172.42.2.0/24 is in the BGP table with best path=True
[PASS]          Test succeeded in 0.1 seconds

[prop_la_ibgp]  Check whether DUT propagates local-as IBGP routes to real IBGP neighbors [ node(s): x3 ]
[WARNING]       Node x3: There is no path to 172.42.2.0/24 in the BGP table with best path=True
Returned result
================================================================================
prefix: 172.42.2.0/24
version: 0
pathCount: 1
paths:
- aspath:
    string: Local
    segments: []
    length: 0
  origin: IGP
  metric: 0
  locPrf: 100
  valid: false
  version: 0
  lastUpdate:
    epoch: 1764702085
    string: Tue Dec  2 19:01:25 2025
  nexthops:
  - ip: 172.16.1.3
    afi: ipv4
    accessible: false
    importCheckEnabled: true
    used: true
  peer:
    peerId: 172.16.2.1
    routerId: 10.0.0.1
    type: internal


[prop_internal] Check whether DUT propagates real IBGP routes over IBGP local-as session [ node(s): x2,x4 ]
[PASS]          x2: The prefix 172.42.3.0/24 is in the BGP table
[PASS]          x4: The prefix 172.42.3.0/24 is in the BGP table
[PASS]          Test succeeded in 0.2 seconds

[nh_internal]   Check whether DUT fixes the next hop of IBGP routes sent over IBGP local-as session [ node(s): x2,x4 ]
[PASS]          x2: The prefix 172.42.3.0/24 is in the BGP table with best path=True
[PASS]          x4: The prefix 172.42.3.0/24 is in the BGP table with best path=True
[PASS]          Test succeeded in 0.2 seconds

[prop_interas]  Check whether all routers receive a prefix from X4 [ node(s): x1,x2,x3 ]
[PASS]          x1: The prefix 172.42.4.0/24 is in the BGP table with best path=True
[PASS]          x2: The prefix 172.42.4.0/24 is in the BGP table with best path=True
[WARNING]       Node x3: There is no path to 172.42.4.0/24 in the BGP table with best path=True
Returned result
================================================================================
prefix: 172.42.4.0/24
version: 0
pathCount: 1
paths:
- aspath:
    string: Local
    segments: []
    length: 0
  origin: IGP
  metric: 0
  locPrf: 100
  valid: false
  version: 0
  originatorId: 172.42.4.1
  clusterList:
    list:
    - 172.42.2.1
  lastUpdate:
    epoch: 1764702086
    string: Tue Dec  2 19:01:26 2025
  nexthops:
  - ip: 172.16.1.3
    afi: ipv4
    accessible: false
    importCheckEnabled: true
    used: true
  peer:
    peerId: 172.16.2.1
    routerId: 10.0.0.1
    type: internal


[INFO]          2 tests out of 22 tests generated a warning
