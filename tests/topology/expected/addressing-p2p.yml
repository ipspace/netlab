input:
- topology/input/addressing-p2p.yml
- package:topology-defaults.yml
links:
- left:
    ifname: swp1
    ipv4: true
    node: r1
  linkindex: 1
  name: Standard P2P link (IPv4-only unnumbered)
  node_count: 2
  prefix:
    ipv4: true
  r1:
    ipv4: true
  r2:
    ipv4: true
  right:
    ifname: swp1
    ipv4: true
    node: r2
  type: p2p
- left:
    ifname: swp2
    ipv4: 10.42.42.18/32
    node: r1
  linkindex: 2
  name: IPv4-only unnumbered link with static IPv4 and IPv6 addresses
  node_count: 2
  prefix:
    ipv4: true
  r1:
    ipv4: 10.42.42.18/32
  r2:
    ipv4: true
    ipv6: 2001:db8:42:44::1/64
  right:
    ifname: swp2
    ipv4: true
    ipv6: 2001:db8:42:44::1/64
    node: r2
  type: p2p
- left:
    ifname: swp3
    ipv4: true
    node: r1
  linkindex: 3
  name: P2P unnumbered link (using unnumbered attribute)
  node_count: 2
  r1:
    ipv4: true
  r2:
    ipv4: true
  right:
    ifname: swp3
    ipv4: true
    node: r2
  role: unnumbered
  type: p2p
  unnumbered: true
- left:
    ifname: swp4
    ipv6: 2001:db8:2::1/64
    node: r1
  linkindex: 4
  name: P2P v6only link
  node_count: 2
  prefix:
    ipv6: 2001:db8:2::/64
  r1:
    ipv6: 2001:db8:2::1/64
  r2:
    ipv6: 2001:db8:2::2/64
  right:
    ifname: swp4
    ipv6: 2001:db8:2::2/64
    node: r2
  role: v6only
  type: p2p
- left:
    ifname: swp5
    ipv4: 172.17.0.1/29
    ipv6: 2001:db8:3::1/64
    node: r1
  linkindex: 5
  name: P2P dual-stack link with non-standard prefix length
  node_count: 2
  prefix:
    ipv4: 172.17.0.0/29
    ipv6: 2001:db8:3::/64
  r1:
    ipv4: 172.17.0.1/29
    ipv6: 2001:db8:3::1/64
  r2:
    ipv4: 172.17.0.2/29
    ipv6: 2001:db8:3::2/64
  right:
    ifname: swp5
    ipv4: 172.17.0.2/29
    ipv6: 2001:db8:3::2/64
    node: r2
  role: dualstack
  type: p2p
- left:
    ifname: swp6
    node: r1
  linkindex: 6
  name: P2P L2only link
  node_count: 2
  r1: {}
  r2: {}
  right:
    ifname: swp6
    node: r2
  role: l2only
  type: p2p
- left:
    ifname: swp7
    ipv4: 172.17.0.11/29
    ipv6: 2001:db8:3:1::7/64
    node: r1
  linkindex: 7
  name: P2P link with custom node IDs
  node_count: 2
  prefix:
    ipv4: 172.17.0.8/29
    ipv6: 2001:db8:3:1::/64
  r1:
    ipv4: 172.17.0.11/29
    ipv6: 2001:db8:3:1::7/64
  r2:
    ipv4: 172.17.0.10/29
    ipv6: 2001:db8:3:1::2a/64
  right:
    ifname: swp7
    ipv4: 172.17.0.10/29
    ipv6: 2001:db8:3:1::2a/64
    node: r2
  role: dualstack
  type: p2p
- left:
    ifname: swp8
    ipv4: true
    ipv6: 2001:db8:3:2::1/64
    node: r1
  linkindex: 8
  name: P2P link with one unnumbered node
  node_count: 2
  prefix:
    ipv4: 172.17.0.16/29
    ipv6: 2001:db8:3:2::/64
  r1:
    ipv4: true
    ipv6: 2001:db8:3:2::1/64
  r2:
    ipv4: 172.17.0.18/29
    ipv6: true
  right:
    ifname: swp8
    ipv4: 172.17.0.18/29
    ipv6: true
    node: r2
  role: dualstack
  type: p2p
- left:
    ifname: swp9
    ipv4: 10.0.0.1/30
    node: r1
  linkindex: 9
  name: P2P l2only link with a static IP address
  node_count: 2
  r1:
    ipv4: 10.0.0.1/30
  r2: {}
  right:
    ifname: swp9
    node: r2
  role: l2only
  type: p2p
- left:
    ifname: swp10
    node: r1
  linkindex: 10
  name: l2only P2P link
  node_count: 2
  prefix: false
  r1: {}
  r2:
    ipv4: 10.42.42.17/32
  right:
    ifname: swp10
    ipv4: 10.42.42.17/32
    node: r2
  type: p2p
- left:
    ifname: swp11
    ipv4: 172.42.42.1/28
    node: r1
  linkindex: 11
  name: P2P link with static prefix
  node_count: 2
  prefix: 172.42.42.0/28
  r1:
    ipv4: 172.42.42.1/28
  r2:
    ipv4: 172.42.42.2/28
  right:
    ifname: swp11
    ipv4: 172.42.42.2/28
    node: r2
  type: p2p
- left:
    ifname: swp12
    ipv4: 172.42.42.17/28
    ipv6: 2001:db8:42:42::1/64
    node: r1
  linkindex: 12
  name: P2P link with static dual-stack prefix
  node_count: 2
  prefix:
    ipv4: 172.42.42.16/28
    ipv6: 2001:db8:42:42::/64
  r1:
    ipv4: 172.42.42.17/28
    ipv6: 2001:db8:42:42::1/64
  r2:
    ipv4: 172.42.42.18/28
    ipv6: 2001:db8:42:42::2/64
  right:
    ifname: swp12
    ipv4: 172.42.42.18/28
    ipv6: 2001:db8:42:42::2/64
    node: r2
  type: p2p
- left:
    ifname: swp13
    ipv4: true
    ipv6: 2001:db8:42:43::1/64
    node: r1
  linkindex: 13
  name: P2P link with unnumbered static prefix
  node_count: 2
  prefix:
    ipv4: true
    ipv6: 2001:db8:42:43::/64
  r1:
    ipv4: true
    ipv6: 2001:db8:42:43::1/64
  r2:
    ipv4: true
    ipv6: 2001:db8:42:43::2/64
  right:
    ifname: swp13
    ipv4: true
    ipv6: 2001:db8:42:43::2/64
    node: r2
  type: p2p
- left:
    ifname: swp14
    ipv4: 10.42.42.18/32
    node: r1
  linkindex: 14
  name: Host addresses on a P2P link (useless but should work)
  node_count: 2
  prefix:
    ipv4: true
  r1:
    ipv4: 10.42.42.18/32
  r2:
    ipv4: true
    ipv6: 2001:db8:42:44::1/128
  right:
    ifname: swp14
    ipv4: true
    ipv6: 2001:db8:42:44::1/128
    node: r2
  type: p2p
name: input
nodes:
- box: CumulusCommunity/cumulus-vx
  device: cumulus
  id: 7
  links:
  - ifindex: 1
    ifname: swp1
    ipv4: true
    linkindex: 1
    name: Standard P2P link (IPv4-only unnumbered)
    neighbors:
      r2:
        ifname: swp1
        ipv4: true
    remote_id: 21
    remote_ifindex: 1
    type: p2p
  - ifindex: 2
    ifname: swp2
    ipv4: 10.42.42.18/32
    linkindex: 2
    name: IPv4-only unnumbered link with static IPv4 and IPv6 addresses
    neighbors:
      r2:
        ifname: swp2
        ipv4: true
        ipv6: 2001:db8:42:44::1/64
    remote_id: 21
    remote_ifindex: 2
    type: p2p
  - ifindex: 3
    ifname: swp3
    ipv4: true
    linkindex: 3
    name: P2P unnumbered link (using unnumbered attribute)
    neighbors:
      r2:
        ifname: swp3
        ipv4: true
    remote_id: 21
    remote_ifindex: 3
    role: unnumbered
    type: p2p
    unnumbered: true
  - ifindex: 4
    ifname: swp4
    ipv6: 2001:db8:2::1/64
    linkindex: 4
    name: P2P v6only link
    neighbors:
      r2:
        ifname: swp4
        ipv6: 2001:db8:2::2/64
    remote_id: 21
    remote_ifindex: 4
    role: v6only
    type: p2p
  - ifindex: 5
    ifname: swp5
    ipv4: 172.17.0.1/29
    ipv6: 2001:db8:3::1/64
    linkindex: 5
    name: P2P dual-stack link with non-standard prefix length
    neighbors:
      r2:
        ifname: swp5
        ipv4: 172.17.0.2/29
        ipv6: 2001:db8:3::2/64
    remote_id: 21
    remote_ifindex: 5
    role: dualstack
    type: p2p
  - ifindex: 6
    ifname: swp6
    linkindex: 6
    name: P2P L2only link
    neighbors:
      r2:
        ifname: swp6
    remote_id: 21
    remote_ifindex: 6
    role: l2only
    type: p2p
  - ifindex: 7
    ifname: swp7
    ipv4: 172.17.0.11/29
    ipv6: 2001:db8:3:1::7/64
    linkindex: 7
    name: P2P link with custom node IDs
    neighbors:
      r2:
        ifname: swp7
        ipv4: 172.17.0.10/29
        ipv6: 2001:db8:3:1::2a/64
    remote_id: 21
    remote_ifindex: 7
    role: dualstack
    type: p2p
  - ifindex: 8
    ifname: swp8
    ipv4: true
    ipv6: 2001:db8:3:2::1/64
    linkindex: 8
    name: P2P link with one unnumbered node
    neighbors:
      r2:
        ifname: swp8
        ipv4: 172.17.0.18/29
        ipv6: true
    remote_id: 21
    remote_ifindex: 8
    role: dualstack
    type: p2p
  - ifindex: 9
    ifname: swp9
    ipv4: 10.0.0.1/30
    linkindex: 9
    name: P2P l2only link with a static IP address
    neighbors:
      r2:
        ifname: swp9
    remote_id: 21
    remote_ifindex: 9
    role: l2only
    type: p2p
  - ifindex: 10
    ifname: swp10
    linkindex: 10
    name: l2only P2P link
    neighbors:
      r2:
        ifname: swp10
        ipv4: 10.42.42.17/32
    remote_id: 21
    remote_ifindex: 10
    type: p2p
  - ifindex: 11
    ifname: swp11
    ipv4: 172.42.42.1/28
    linkindex: 11
    name: P2P link with static prefix
    neighbors:
      r2:
        ifname: swp11
        ipv4: 172.42.42.2/28
    remote_id: 21
    remote_ifindex: 11
    type: p2p
  - ifindex: 12
    ifname: swp12
    ipv4: 172.42.42.17/28
    ipv6: 2001:db8:42:42::1/64
    linkindex: 12
    name: P2P link with static dual-stack prefix
    neighbors:
      r2:
        ifname: swp12
        ipv4: 172.42.42.18/28
        ipv6: 2001:db8:42:42::2/64
    remote_id: 21
    remote_ifindex: 12
    type: p2p
  - ifindex: 13
    ifname: swp13
    ipv4: true
    ipv6: 2001:db8:42:43::1/64
    linkindex: 13
    name: P2P link with unnumbered static prefix
    neighbors:
      r2:
        ifname: swp13
        ipv4: true
        ipv6: 2001:db8:42:43::2/64
    remote_id: 21
    remote_ifindex: 13
    type: p2p
  - ifindex: 14
    ifname: swp14
    ipv4: 10.42.42.18/32
    linkindex: 14
    name: Host addresses on a P2P link (useless but should work)
    neighbors:
      r2:
        ifname: swp14
        ipv4: true
        ipv6: 2001:db8:42:44::1/128
    remote_id: 21
    remote_ifindex: 14
    type: p2p
  loopback:
    ipv4: 10.0.0.7/32
  mgmt:
    ifname: eth0
    ipv4: 192.168.121.107
    mac: 08-4F-A9-00-00-07
  name: r1
- box: CumulusCommunity/cumulus-vx
  device: cumulus
  id: 21
  links:
  - ifindex: 1
    ifname: swp1
    ipv4: true
    linkindex: 1
    name: Standard P2P link (IPv4-only unnumbered)
    neighbors:
      r1:
        ifname: swp1
        ipv4: true
    remote_id: 7
    remote_ifindex: 1
    type: p2p
  - ifindex: 2
    ifname: swp2
    ipv4: true
    ipv6: 2001:db8:42:44::1/64
    linkindex: 2
    name: IPv4-only unnumbered link with static IPv4 and IPv6 addresses
    neighbors:
      r1:
        ifname: swp2
        ipv4: 10.42.42.18/32
    remote_id: 7
    remote_ifindex: 2
    type: p2p
  - ifindex: 3
    ifname: swp3
    ipv4: true
    linkindex: 3
    name: P2P unnumbered link (using unnumbered attribute)
    neighbors:
      r1:
        ifname: swp3
        ipv4: true
    remote_id: 7
    remote_ifindex: 3
    role: unnumbered
    type: p2p
    unnumbered: true
  - ifindex: 4
    ifname: swp4
    ipv6: 2001:db8:2::2/64
    linkindex: 4
    name: P2P v6only link
    neighbors:
      r1:
        ifname: swp4
        ipv6: 2001:db8:2::1/64
    remote_id: 7
    remote_ifindex: 4
    role: v6only
    type: p2p
  - ifindex: 5
    ifname: swp5
    ipv4: 172.17.0.2/29
    ipv6: 2001:db8:3::2/64
    linkindex: 5
    name: P2P dual-stack link with non-standard prefix length
    neighbors:
      r1:
        ifname: swp5
        ipv4: 172.17.0.1/29
        ipv6: 2001:db8:3::1/64
    remote_id: 7
    remote_ifindex: 5
    role: dualstack
    type: p2p
  - ifindex: 6
    ifname: swp6
    linkindex: 6
    name: P2P L2only link
    neighbors:
      r1:
        ifname: swp6
    remote_id: 7
    remote_ifindex: 6
    role: l2only
    type: p2p
  - ifindex: 7
    ifname: swp7
    ipv4: 172.17.0.10/29
    ipv6: 2001:db8:3:1::2a/64
    linkindex: 7
    name: P2P link with custom node IDs
    neighbors:
      r1:
        ifname: swp7
        ipv4: 172.17.0.11/29
        ipv6: 2001:db8:3:1::7/64
    remote_id: 7
    remote_ifindex: 7
    role: dualstack
    type: p2p
  - ifindex: 8
    ifname: swp8
    ipv4: 172.17.0.18/29
    ipv6: true
    linkindex: 8
    name: P2P link with one unnumbered node
    neighbors:
      r1:
        ifname: swp8
        ipv4: true
        ipv6: 2001:db8:3:2::1/64
    remote_id: 7
    remote_ifindex: 8
    role: dualstack
    type: p2p
  - ifindex: 9
    ifname: swp9
    linkindex: 9
    name: P2P l2only link with a static IP address
    neighbors:
      r1:
        ifname: swp9
        ipv4: 10.0.0.1/30
    remote_id: 7
    remote_ifindex: 9
    role: l2only
    type: p2p
  - ifindex: 10
    ifname: swp10
    ipv4: 10.42.42.17/32
    linkindex: 10
    name: l2only P2P link
    neighbors:
      r1:
        ifname: swp10
    remote_id: 7
    remote_ifindex: 10
    type: p2p
  - ifindex: 11
    ifname: swp11
    ipv4: 172.42.42.2/28
    linkindex: 11
    name: P2P link with static prefix
    neighbors:
      r1:
        ifname: swp11
        ipv4: 172.42.42.1/28
    remote_id: 7
    remote_ifindex: 11
    type: p2p
  - ifindex: 12
    ifname: swp12
    ipv4: 172.42.42.18/28
    ipv6: 2001:db8:42:42::2/64
    linkindex: 12
    name: P2P link with static dual-stack prefix
    neighbors:
      r1:
        ifname: swp12
        ipv4: 172.42.42.17/28
        ipv6: 2001:db8:42:42::1/64
    remote_id: 7
    remote_ifindex: 12
    type: p2p
  - ifindex: 13
    ifname: swp13
    ipv4: true
    ipv6: 2001:db8:42:43::2/64
    linkindex: 13
    name: P2P link with unnumbered static prefix
    neighbors:
      r1:
        ifname: swp13
        ipv4: true
        ipv6: 2001:db8:42:43::1/64
    remote_id: 7
    remote_ifindex: 13
    type: p2p
  - ifindex: 14
    ifname: swp14
    ipv4: true
    ipv6: 2001:db8:42:44::1/128
    linkindex: 14
    name: Host addresses on a P2P link (useless but should work)
    neighbors:
      r1:
        ifname: swp14
        ipv4: 10.42.42.18/32
    remote_id: 7
    remote_ifindex: 14
    type: p2p
  loopback:
    ipv4: 10.0.0.21/32
  mgmt:
    ifname: eth0
    ipv4: 192.168.121.121
    mac: 08-4F-A9-00-00-15
  name: r2
- box: CumulusCommunity/cumulus-vx
  device: cumulus
  id: 42
  loopback:
    ipv4: 10.0.0.42/32
  mgmt:
    ifname: eth0
    ipv4: 192.168.121.142
    mac: 08-4F-A9-00-00-2A
  name: r3
- box: CumulusCommunity/cumulus-vx
  device: cumulus
  id: 1
  loopback:
    ipv4: 10.0.0.1/32
  mgmt:
    ifname: eth0
    ipv4: 192.168.121.101
    mac: 08-4F-A9-00-00-01
  name: r4
provider: libvirt
