---
message: |
  The devices under test are a pair of routers with a L3 LAG link between them
  h1 and h2 should be able to ping each other
groups:
  _auto_create: True
  hosts:
    members: [ h1, h2 ]
    device: linux
    provider: clab
  switches:
    members: [ r1,r2,r3 ]
    module: [ lag, ospf ]

links:
- r1:  # Need valid nodes on the link
  r2:
  lag.members: 2
- r2:  # Need valid nodes on the link
  r3:
  lag.members: 2
- h1-r1
- r3-h2

validate:
  ping:
    description: Pinging H2 from H1
    nodes: [ h1 ]
    wait_msg: Waiting for STP to enable the ports
    wait: 45
    plugin: ping('h2')