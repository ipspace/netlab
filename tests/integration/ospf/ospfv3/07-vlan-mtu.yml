---
message: |
  This lab tests OSPFv3 adjacencies on VLAN interfaces with non-default MTU
  settings. The adjacency establishment could fail due to MTU mismatch.

  Failure to establish X2-DUT adjacency means that the VLAN interface does not
  get the correct MTU. Failure to establish X1-DUT adjacency indicates a
  potential problem with system MTU.

module: [ ospf, vlan ]

vlans:
  ospf_1:
    links: [ dut-x1 ]
    ospf.network_type: point-to-point
  ospf_2:
    mtu: 1580 # 1280
    links: [ dut-x2 ]
    ospf.network_type: point-to-point

groups:
  probe:
    device: eos
    provider: clab
    members: [ x1, x2 ]

nodes:
  dut:
    mtu: 1436 # 1400
  x1:
    mtu: 1436 # 1400
  x2:

validate:
  adj:
    description: Check OSPF adjacencies
    wait_msg: Waiting for OSPF adjacency process to complete
    wait: 60
    nodes: [ x1, x2 ]
    plugin: ospf6_neighbor(nodes.dut.ospf.router_id)
