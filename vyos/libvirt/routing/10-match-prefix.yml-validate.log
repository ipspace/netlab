[ebgp_v4]        Check IPv4 EBGP sessions with DUT [ node(s): x1,x2,x3,vx1,vx2,vx3 ]
[PASS]           x1: Neighbor 10.1.0.1 (dut) is in state Established
[PASS]           x2: Neighbor 10.1.0.5 (dut) is in state Established
[PASS]           x3: Neighbor 10.1.0.9 (dut) is in state Established
[PASS]           vx1: Neighbor 10.1.0.13 (dut) is in state Established
[PASS]           vx2: Neighbor 10.1.0.17 (dut) is in state Established
[PASS]           vx3: Neighbor 10.1.0.21 (dut) is in state Established
[PASS]           Test succeeded in 0.5 seconds

[ebgp_v6]        Check IPv6 EBGP sessions with DUT [ node(s): x1,x2,x3,vx1,vx2,vx3 ]
[PASS]           x1: Neighbor 2001:db8:3::1 (dut) is in state Established
[PASS]           x2: Neighbor 2001:db8:3:1::1 (dut) is in state Established
[PASS]           x3: Neighbor 2001:db8:3:2::1 (dut) is in state Established
[PASS]           vx1: Neighbor 2001:db8:3:3::1 (dut) is in state Established
[PASS]           vx2: Neighbor 2001:db8:3:4::1 (dut) is in state Established
[PASS]           vx3: Neighbor 2001:db8:3:5::1 (dut) is in state Established
[PASS]           Test succeeded in 0.5 seconds

[pfx_o2_v4]      Check for b_orig_2 IPv4 prefix on X3 [ node(s): x3,vx3 ]
[PASS]           x3: The prefix 172.42.43.0/24 is in the BGP table
[PASS]           vx3: The prefix 172.42.43.0/24 is in the BGP table
[PASS]           Test succeeded in 0.2 seconds

[pfx_o3_v6]      Check for b_orig_3 IPv6 prefix on X3 [ node(s): x3 ]
[PASS]           x3: The prefix 2001:db8:dead:beef::/64 is in the BGP table
[PASS]           Test succeeded in 0.1 seconds

[pfx_wait]       Wait a bit for BGP to settle
[WAITING]        Waiting for 3 seconds, 3 seconds left

[pfx_o1_miss]    Check for missing b_orig_1 IPv4 prefix on X3 (inbound in_x1 IPv4 RP) [ node(s): x3 ]
[FAIL]           Node x3: The prefix 172.42.42.0/24 should not be in the BGP table
Returned result
================================================================================
advertisedTo:
  10.1.0.9:
    hostname: dut
paths:
- aspath:
    length: 2
    segments:
    - list:
      - 65000
      - 65100
      type: as-sequence
    string: 65000 65100
  bestpath:
    bestpathFromAs: 65000
    overall: true
    selectionReason: First path received
  lastUpdate:
    epoch: 1744442297
    string: 'Sat Apr 12 07:18:17 2025

      '
  nexthops:
  - accessible: true
    afi: ipv4
    hostname: dut
    ip: 10.1.0.9
    metric: 0
    used: true
  origin: IGP
  peer:
    hostname: dut
    peerId: 10.1.0.9
    routerId: 10.0.0.1
    type: external
  valid: true
  version: 4
prefix: 172.42.42.0/24
version: 4


[x2_pfx_o3_miss] Check for missing b_orig_3 IPv6 prefix on X2 (outbound out_x2 IPv6 RP) [ node(s): x2 ]
[FAIL]           Node x2: The prefix 2001:db8:dead:beef::/64 should not be in the BGP table
Returned result
================================================================================
advertisedTo:
  2001:db8:3:1::1:
    hostname: dut
paths:
- aspath:
    length: 2
    segments:
    - list:
      - 65000
      - 65100
      type: as-sequence
    string: 65000 65100
  bestpath:
    bestpathFromAs: 65000
    overall: true
    selectionReason: First path received
  lastUpdate:
    epoch: 1744442298
    string: 'Sat Apr 12 07:18:18 2025

      '
  nexthops:
  - accessible: true
    afi: ipv6
    hostname: dut
    ip: 2001:db8:3:1::1
    metric: 0
    scope: global
  - accessible: true
    afi: ipv6
    hostname: dut
    ip: fe80::5054:ff:fefb:bf69
    scope: link-local
    used: true
  origin: IGP
  peer:
    hostname: dut
    peerId: 2001:db8:3:1::1
    routerId: 10.0.0.1
    type: external
  valid: true
  version: 4
prefix: 2001:db8:dead:beef::/64
version: 4


[x2_lb_v4]       Check for X1 loopback IPv4 prefix on X2 [ node(s): x2 ]
[PASS]           x2: The prefix 10.0.0.2/32 is in the BGP table
[PASS]           Test succeeded in 0.1 seconds

[x2_lb_v6]       Check for X1 loopback IPv6 prefix on X2 [ node(s): x2 ]
[PASS]           x2: The prefix 2001:db8:1:2::/64 is in the BGP table
[PASS]           Test succeeded in 0.1 seconds

[vrf_o3_v6]      Check for b_orig_3 IPv6 prefix on VX3 [ node(s): vx3 ]
[PASS]           vx3: The prefix 2001:db8:dead:beef::/64 is in the BGP table
[PASS]           Test succeeded in 0.1 seconds

[vrf_o1_miss]    Check for missing b_orig_1 IPv4 prefix on VX3 (inbound in_x1 IPv4 RP) [ node(s): vx3 ]
[FAIL]           Node vx3: The prefix 172.42.42.0/24 should not be in the BGP table
Returned result
================================================================================
advertisedTo:
  10.1.0.21:
    hostname: dut
paths:
- aspath:
    length: 2
    segments:
    - list:
      - 65000
      - 65100
      type: as-sequence
    string: 65000 65100
  bestpath:
    bestpathFromAs: 65000
    overall: true
    selectionReason: First path received
  lastUpdate:
    epoch: 1744442302
    string: 'Sat Apr 12 07:18:22 2025

      '
  nexthops:
  - accessible: true
    afi: ipv4
    hostname: dut
    ip: 10.1.0.21
    metric: 0
    used: true
  origin: IGP
  peer:
    hostname: dut
    peerId: 10.1.0.21
    routerId: 10.0.0.1
    type: external
  valid: true
  version: 3
prefix: 172.42.42.0/24
version: 3


[vrf_x2_o3_miss] Check for missing b_orig_3 IPv6 prefix on VX2 (outbound out_x2 IPv6 RP) [ node(s): vx2 ]
[FAIL]           Node vx2: The prefix 2001:db8:dead:beef::/64 should not be in the BGP table
Returned result
================================================================================
advertisedTo:
  2001:db8:3:4::1:
    hostname: dut
paths:
- aspath:
    length: 2
    segments:
    - list:
      - 65000
      - 65100
      type: as-sequence
    string: 65000 65100
  bestpath:
    bestpathFromAs: 65000
    overall: true
    selectionReason: First path received
  lastUpdate:
    epoch: 1744442302
    string: 'Sat Apr 12 07:18:22 2025

      '
  nexthops:
  - accessible: true
    afi: ipv6
    hostname: dut
    ip: 2001:db8:3:4::1
    metric: 0
    scope: global
  - accessible: true
    afi: ipv6
    hostname: dut
    ip: fe80::5054:ff:fefe:92f0
    scope: link-local
    used: true
  origin: IGP
  peer:
    hostname: dut
    peerId: 2001:db8:3:4::1
    routerId: 10.0.0.1
    type: external
  valid: true
  version: 3
prefix: 2001:db8:dead:beef::/64
version: 3


[vrf_x2_lb_v4]   Check for VX1 loopback IPv4 prefix on VX2 [ node(s): vx2 ]
[PASS]           vx2: The prefix 10.0.0.5/32 is in the BGP table
[PASS]           Test succeeded in 0.1 seconds

[vrf_x2_lb_v6]   Check for VX1 loopback IPv6 prefix on VX2 [ node(s): vx2 ]
[PASS]           vx2: The prefix 2001:db8:1:5::/64 is in the BGP table
[PASS]           Test succeeded in 0.1 seconds

[FAIL]           24 tests completed, 4 tests failed
