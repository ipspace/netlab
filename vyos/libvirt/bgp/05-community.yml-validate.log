[session]      Check BGP sessions with DUT [ node(s): rc,r2,x1 ]
[PASS]         x1: Neighbor 172.16.2.1 (dut) is in state Established
[WAITING]      Wait for BGP sessions to be established (retrying for 40 seconds)
[WAITING]      Wait for BGP sessions to be established (24 seconds left)
[PASS]         r2: Neighbor 10.0.0.1 (dut) is in state Established
[PASS]         rc: Neighbor 10.0.0.1 (dut) is in state Established
[PASS]         Succeeded in 20.1 seconds
[PASS]         Test succeeded

[prefix]       Check whether DUT propagates the beacon prefix [ node(s): r2,x1 ]
[WAITING]      Wait for BGP convergence (retrying for 5 seconds)
[PASS]         r2: The prefix 172.0.42.0/24 is in the BGP table
[PASS]         x1: The prefix 172.0.42.0/24 is in the BGP table
[PASS]         Succeeded in 1.3 seconds
[PASS]         Test succeeded

[ibgp_comm]    Check community propagation on IBGP sessions [ node(s): r2 ]
[PASS]         r2: The prefix 172.0.42.0/24 contains the expected communities
[PASS]         Test succeeded

[ebgp_comm]    Check community propagation on EBGP sessions [ node(s): x1 ]
[PASS]         x1: The prefix 172.0.42.0/24 contains the expected communities
[PASS]         Test succeeded

[ebgp_no_comm] Check for lack of extended communities on EBGP sessions [ node(s): x1 ]
[FAIL]         x1: extendedCommunity LB:65000:12500000 should not be attached to 172.0.42.0/24
Returned result
================================================================================
advertisedTo:
  172.16.2.1:
    hostname: vyos
paths:
- aspath:
    length: 1
    segments:
    - list:
      - 65000
      type: as-sequence
    string: '65000'
  bestpath:
    bestpathFromAs: 65000
    overall: true
    selectionReason: First path received
  community:
    list:
    - '65000:1'
    string: '65000:1'
  extendedCommunity:
    string: LB:65000:12500000 (100.000 Mbps)
  largeCommunity:
    list:
    - '65000:0:1'
    string: '65000:0:1'
  lastUpdate:
    epoch: 1712746697
    string: 'Wed Apr 10 10:58:17 2024

      '
  nexthops:
  - accessible: true
    afi: ipv4
    hostname: vyos
    ip: 172.16.2.1
    metric: 0
    used: true
  origin: IGP
  peer:
    hostname: vyos
    peerId: 172.16.2.1
    routerId: 10.0.0.1
    type: external
  valid: true
  version: 5
prefix: 172.0.42.0/24
version: 5


[FAIL]         Tests completed, validation failed
