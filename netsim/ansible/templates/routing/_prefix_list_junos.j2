policy-options {

{% for pf_af in af if pf_af in routing._prefix|default({}) %}
{%   for p_name,p_value in routing._prefix[pf_af].items() %}

  delete: route-filter-list {{ p_name }}-{{ pf_af }};

  route-filter-list {{ p_name }}-{{ pf_af }} {

{%     for p_entry in p_value %}
{%       set ns = namespace(match_type='exact') %}
{%       if 'min' in p_entry and 'max' in p_entry %}
{%         set ns.match_type = 'prefix-length-range /%s-/%s'|format(p_entry.min, p_entry.max) %}
{%       elif 'max' in p_entry %}
{%         set ns.match_type = 'upto /%s'|format(p_entry.max) %}
{%       endif %}

    {{ p_entry[pf_af] }} {{ns.match_type}} {
{%       if p_entry.action|default('') == 'deny' %}
      next term;
{%       endif %}
    }

{%     endfor %}

  }

{%   endfor %}
{% endfor %}

}
