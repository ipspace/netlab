- set:
    bridge:
      domain:
        br_default:
          untagged: 1
{% if vlans is defined %}
{%  for vname,vdata in vlans.items() %}
{%   if loop.first %}
          vlan:
{%   endif %}
            '{{ vdata.id }}': {}
{%  endfor %}
{% endif %}

    interface:
{% for i in interfaces if i.vlan is defined and (i.virtual_interface is not defined or i.type=="lag") %}
     {{ i.ifname }}:
        bridge:
          domain:
            br_default:{% if i.vlan.access_id is defined +%}
              access: {{ i.vlan.access_id }}
{%          elif i.vlan.trunk_id is defined and i.type != "lag" %}
              vlan:
{%            for v in i.vlan.trunk_id|sort %}
                '{{ v }}': {}
{%            endfor %}
{%          else %} {}
{%          endif %}
{% endfor %}
