{% for intf in interfaces if intf.evpn._esi is defined %}
interface {{ intf.ifname }}
 evpn ethernet-segment
{%   if intf.evpn._esi.auto|default(false) %}
  identifier auto lacp
{%   else %}
{# Arista wants it in format: 0000:0000:0000:0000:0000 (generated by device quirk) #}
  identifier {{intf.evpn._esi._eos_id}}
{%   endif %}
!
{% endfor %}
!
router bgp {{ bgp.as }}
 address-family evpn
  route type ethernet-segment route-target auto
